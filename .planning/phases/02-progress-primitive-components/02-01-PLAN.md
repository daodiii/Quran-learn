---
phase: 02-progress-primitive-components
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/progress/ProgressBar.astro
  - src/components/progress/ProgressRing.astro
  - src/components/progress/LessonCheckmark.astro
autonomous: true

must_haves:
  truths:
    - "ProgressBar visually displays 0-100% completion horizontally"
    - "ProgressRing shows X/Y lesson count in circular format"
    - "LessonCheckmark displays completed vs incomplete states"
    - "All progress components announce state to screen readers"
    - "Animations respect prefers-reduced-motion"
  artifacts:
    - path: "src/components/progress/ProgressBar.astro"
      provides: "Horizontal progress bar with ARIA"
      exports: ["Props interface"]
      min_lines: 60
    - path: "src/components/progress/ProgressRing.astro"
      provides: "Circular progress with SVG"
      exports: ["Props interface"]
      min_lines: 80
    - path: "src/components/progress/LessonCheckmark.astro"
      provides: "Binary completion indicator"
      exports: ["Props interface"]
      min_lines: 40
  key_links:
    - from: "ProgressBar.astro"
      to: "src/styles/tokens/colors.css"
      via: "CSS variable references"
      pattern: "var\\(--color-"
    - from: "ProgressRing.astro"
      to: "src/styles/tokens/colors.css"
      via: "CSS variable references"
      pattern: "var\\(--color-"
    - from: "All progress components"
      to: "ARIA progressbar pattern"
      via: "role, aria-valuenow, aria-valuemin, aria-valuemax"
      pattern: "role=\"progressbar\""
---

<objective>
Create three progress visualization components: ProgressBar (horizontal 0-100%), ProgressRing (circular X/Y), and LessonCheckmark (binary state).

Purpose: DESIGN-02 requires clean progress visualization. These components will be used throughout the app for lesson completion, module progress, and course overview.

Output: Three Astro components in `/src/components/progress/` with TypeScript props, ARIA accessibility, design token integration, and reduced-motion support.
</objective>

<execution_context>
@/Users/daodilyas/.claude/get-shit-done/workflows/execute-plan.md
@/Users/daodilyas/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-progress-primitive-components/02-RESEARCH.md

# Design tokens (from Phase 1)
@src/styles/global.css
@src/styles/tokens/colors.css
@src/styles/tokens/spacing.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ProgressBar component</name>
  <files>src/components/progress/ProgressBar.astro</files>
  <action>
Create the progress directory and ProgressBar.astro component:

**Props interface:**
```typescript
interface Props {
  value: number;              // Current progress (0-max)
  max?: number;               // Maximum value (default: 100)
  label: string;              // Accessible name (REQUIRED)
  showLabel?: boolean;        // Display visible label (default: true)
  showPercentage?: boolean;   // Show percentage text (default: false)
  height?: 'sm' | 'md' | 'lg'; // Bar height (default: 'md')
}
```

**Implementation requirements:**
- Use `role="progressbar"` with `aria-valuenow`, `aria-valuemin`, `aria-valuemax`
- Use `aria-labelledby` when showLabel is true, otherwise use `aria-label`
- Calculate percentage: `Math.min(100, Math.max(0, (value / max) * 100))`
- Use CSS logical properties (inline-size, block-size, margin-block-end)
- Reference design tokens: `var(--color-accent-primary)`, `var(--color-background-tertiary)`, `var(--spacing-*)`, `var(--radius-full)`
- Include `@media (prefers-reduced-motion: reduce)` to disable transitions
- Height variants: sm=4px, md=8px, lg=12px
- Transition: `inline-size 500ms cubic-bezier(0.4, 0, 0.2, 1)`

**Style structure:**
- .progress-bar-wrapper (full width container)
- .progress-header (flex, space-between, for label and percentage)
- .progress-track (track background, tertiary color)
- .progress-fill (fill with accent-primary, animated width)

See research document Pattern 2 and Code Examples for exact implementation.
  </action>
  <verify>
- File exists at src/components/progress/ProgressBar.astro
- Contains TypeScript Props interface
- Has role="progressbar" with all required ARIA attributes
- Uses CSS logical properties (grep for "inline-size")
- Has @media (prefers-reduced-motion: reduce) block
- References design token variables
  </verify>
  <done>
ProgressBar component renders horizontal progress with accessible ARIA attributes, three height variants, optional label/percentage display, and reduced-motion support.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create ProgressRing component</name>
  <files>src/components/progress/ProgressRing.astro</files>
  <action>
Create ProgressRing.astro component using SVG circles:

**Props interface:**
```typescript
interface Props {
  current: number;            // Completed count
  total: number;              // Total count
  label: string;              // Accessible name (REQUIRED)
  size?: number;              // Diameter in px (default: 120)
  strokeWidth?: number;       // Ring thickness (default: 8)
  showText?: boolean;         // Display center text (default: true)
}
```

**SVG Mathematics (exact formula from research):**
```javascript
const center = size / 2;
const radius = center - strokeWidth;  // NOT size / 2
const circumference = 2 * Math.PI * radius;
const progress = Math.min(100, (current / total) * 100);
const offset = circumference * ((100 - progress) / 100);  // NOT (progress / 100)
```

**Implementation requirements:**
- SVG with two circles: background track and progress fill
- Progress circle uses stroke-dasharray and stroke-dashoffset
- Rotate -90 degrees to start at 12 o'clock: `transform="rotate(-90 center center)"`
- Use `stroke-linecap="round"` for smooth ends
- Put ARIA progressbar on a hidden div (for screen readers), NOT on SVG circle
- Use `aria-valuetext` for clearer announcement: "X of Y completed"
- Include .sr-only class for screen reader content
- Center text shows "current / total" visually (aria-hidden="true")
- Reference tokens: `var(--color-accent-primary)`, `var(--color-background-tertiary)`
- Transition: `stroke-dashoffset 600ms cubic-bezier(0.4, 0, 0.2, 1)`
- Include prefers-reduced-motion media query

**Structure:**
- Wrapper div with position: relative
- SVG with aria-hidden="true" (visual only)
- Hidden div with role="progressbar" for accessibility
- Center text div with current/total (aria-hidden="true")

See research document Pattern 3 and Code Examples for exact implementation.
  </action>
  <verify>
- File exists at src/components/progress/ProgressRing.astro
- Contains TypeScript Props interface with current, total, label
- Has SVG with two circles (track and progress)
- Uses correct stroke-dasharray/offset calculation
- Has rotate(-90) transform for 12 o'clock start
- Has hidden role="progressbar" div with aria-valuetext
- Has @media (prefers-reduced-motion: reduce) block
  </verify>
  <done>
ProgressRing component displays circular X/Y progress using SVG, with proper 12 o'clock start position, screen reader accessible hidden element, and animated stroke transitions.
  </done>
</task>

<task type="auto">
  <name>Task 3: Create LessonCheckmark component</name>
  <files>src/components/progress/LessonCheckmark.astro</files>
  <action>
Create LessonCheckmark.astro component for binary completion state:

**Props interface:**
```typescript
interface Props {
  completed: boolean;         // Completion state
  size?: number;              // Icon size in px (default: 24)
  label?: string;             // Accessible label (default: "Lesson complete")
  showLabel?: boolean;        // Display label text (default: false)
}
```

**Implementation requirements:**
- Use role="img" with aria-label on the icon container
- Two visual states:
  - Completed: Filled circle with checkmark path
  - Incomplete: Empty circle outline
- Completed circle fill: `var(--color-accent-primary)`
- Checkmark stroke: white, stroke-width 2.5
- Checkmark path: `d="M7 12l3 3 7-7"`
- Incomplete circle stroke: `var(--color-border-secondary)`
- Optional animation for completed state:
  - Circle: scale animation (0.8 -> 1.1 -> 1)
  - Checkmark: stroke-dashoffset draw animation
- Include prefers-reduced-motion to disable animations
- Optional visible label with color change based on completed state

**Structure:**
- .lesson-checkmark wrapper (inline-flex, gap)
- .checkmark-circle container with data-completed attribute
- SVG with conditional content (filled circle + path OR empty circle)
- Optional span for label text

**Checkmark is symmetric - no RTL mirroring needed.**

See research document Code Examples section for exact implementation.
  </action>
  <verify>
- File exists at src/components/progress/LessonCheckmark.astro
- Contains TypeScript Props interface with completed boolean
- Has role="img" with aria-label
- Renders different SVG for completed vs incomplete
- Uses design token colors
- Has animation keyframes with prefers-reduced-motion fallback
  </verify>
  <done>
LessonCheckmark component shows binary completion state with animated checkmark on complete, accessible role="img", and optional label display.
  </done>
</task>

</tasks>

<verification>
After all tasks complete:

1. Verify all three component files exist:
```bash
ls -la src/components/progress/
```

2. Verify ARIA accessibility patterns:
```bash
grep -l "role=" src/components/progress/*.astro
grep -l "aria-" src/components/progress/*.astro
```

3. Verify CSS logical properties usage:
```bash
grep -l "inline-size\|block-size" src/components/progress/*.astro
```

4. Verify reduced-motion support:
```bash
grep -l "prefers-reduced-motion" src/components/progress/*.astro
```

5. Verify design token usage:
```bash
grep -c "var(--" src/components/progress/*.astro
```
</verification>

<success_criteria>
- Three components exist in src/components/progress/
- All components have TypeScript Props interfaces
- ProgressBar and ProgressRing use role="progressbar" with ARIA value attributes
- LessonCheckmark uses role="img" with aria-label
- All CSS uses logical properties (inline-size, not width)
- All animations respect prefers-reduced-motion
- All colors/spacing reference design tokens (no hardcoded values)
- ProgressRing SVG math is correct (progress starts at 12 o'clock)
</success_criteria>

<output>
After completion, create `.planning/phases/02-progress-primitive-components/02-01-SUMMARY.md`
</output>
