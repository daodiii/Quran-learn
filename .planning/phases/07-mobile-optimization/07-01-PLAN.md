---
phase: 07-mobile-optimization
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/styles/global.css
  - src/components/navigation/CourseNavigator.astro
autonomous: true

must_haves:
  truths:
    - "iOS Safari does not inflate Arabic text on landscape rotation"
    - "All touch targets meet 44px minimum on touch devices"
    - "Touch targets have adequate spacing (8px minimum)"
  artifacts:
    - path: "src/styles/global.css"
      provides: "text-size-adjust and touch target CSS"
      contains: "text-size-adjust: 100%"
    - path: "src/components/navigation/CourseNavigator.astro"
      provides: "Mobile-optimized touch targets"
      contains: "min-block-size: 44px"
  key_links:
    - from: "global.css"
      to: "html element"
      via: "text-size-adjust property"
      pattern: "-webkit-text-size-adjust:\\s*100%"
---

<objective>
Add iOS-specific typography controls and ensure all touch targets meet mobile accessibility requirements.

Purpose: Prevent iOS Safari font inflation on landscape rotation and ensure comfortable touch interaction on mobile devices. This addresses WCAG 2.5.8 touch target requirements and iOS-specific text rendering issues identified in research.

Output: Updated global.css with text-size-adjust, touch target sizing, and target spacing rules. Updated CourseNavigator with mobile-optimized touch areas.
</objective>

<execution_context>
@/Users/daodilyas/.claude/get-shit-done/workflows/execute-plan.md
@/Users/daodilyas/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-mobile-optimization/07-RESEARCH.md
@src/styles/global.css
@src/components/navigation/CourseNavigator.astro
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add iOS text-size-adjust and enhance touch target CSS</name>
  <files>src/styles/global.css</files>
  <action>
Update global.css with the following changes:

1. Add text-size-adjust to html element in @layer base:
```css
html {
  scroll-behavior: smooth;
  color-scheme: light;
  -webkit-text-size-adjust: 100%; /* Prevent iOS Safari font inflation on landscape */
  text-size-adjust: 100%; /* Standard property for future compatibility */
}
```

2. Enhance existing touch target rules at @media (pointer: coarse) (currently lines 423-430):
```css
/* Touch-friendly tap targets on mobile (WCAG 2.5.8 minimum 24px, iOS HIG 44px) */
@media (pointer: coarse) {
  button,
  a,
  .quiz-option,
  input[type="checkbox"],
  input[type="radio"],
  select {
    min-block-size: 44px;
    min-inline-size: 44px;
  }

  /* Ensure adequate spacing between adjacent touch targets */
  .quiz-option + .quiz-option,
  .nav-link + .nav-link,
  .btn + .btn {
    margin-block-start: 8px;
  }
}
```

Note: Use CSS logical properties (min-block-size, min-inline-size) instead of min-height/min-width for RTL compatibility. This was established as a convention in Phase 2.
  </action>
  <verify>
Run `grep -n "text-size-adjust" src/styles/global.css` to confirm property added.
Run `grep -n "min-block-size: 44px" src/styles/global.css` to confirm touch target sizing.
  </verify>
  <done>
text-size-adjust: 100% present on html element. Touch targets have min-block-size and min-inline-size of 44px. Adjacent touch targets have 8px spacing.
  </done>
</task>

<task type="auto">
  <name>Task 2: Optimize CourseNavigator touch targets for mobile</name>
  <files>src/components/navigation/CourseNavigator.astro</files>
  <action>
Update the component's style section to ensure mobile touch targets meet 44px minimum:

1. Update .level-header to have minimum 44px height:
```css
.level-header {
  /* existing styles */
  min-block-size: 44px;
}
```

2. Update .lesson-item to have minimum 44px height:
```css
.lesson-item {
  /* existing styles */
  min-block-size: 44px;
}
```

3. Update .quiz-link to have minimum 44px height:
```css
.quiz-link {
  /* existing styles */
  min-block-size: 44px;
}
```

4. Update .close-navigator button (currently 32px) to 44px for mobile:
```css
.close-navigator {
  /* Change from 32px to 44px */
  inline-size: 44px;
  block-size: 44px;
}
```

5. Add spacing between quiz links:
```css
.quiz-links {
  /* existing styles, update gap */
  gap: 0.5rem; /* 8px minimum spacing */
}
```

Note: These changes ensure all interactive elements in the navigator are comfortable to tap on touch devices.
  </action>
  <verify>
Run `grep -n "min-block-size: 44px" src/components/navigation/CourseNavigator.astro` to confirm touch target sizing applied.
Run `npm run build` to ensure no build errors.
  </verify>
  <done>
All interactive elements in CourseNavigator (.level-header, .lesson-item, .quiz-link, .close-navigator) have 44px minimum touch target size. Quiz links have 8px spacing.
  </done>
</task>

</tasks>

<verification>
1. `npm run build` completes without errors
2. `grep -rn "text-size-adjust" src/` shows property in global.css
3. `grep -rn "min-block-size: 44px" src/` shows touch target sizing in both files
</verification>

<success_criteria>
- text-size-adjust: 100% applied to html element in global.css
- All touch targets (buttons, links, inputs) have 44px minimum dimension under @media (pointer: coarse)
- CourseNavigator interactive elements meet 44px touch target requirement
- Adjacent touch targets have 8px minimum spacing
- Build passes without errors
</success_criteria>

<output>
After completion, create `.planning/phases/07-mobile-optimization/07-01-SUMMARY.md`
</output>
