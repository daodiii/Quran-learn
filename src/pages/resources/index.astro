---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Container from '../../components/primitives/Container.astro';
import CardGrid from '../../components/cards/CardGrid.astro';
import ResourceCard from '../../components/cards/ResourceCard.astro';
import { getCollection } from 'astro:content';

const allResources = await getCollection('resources');
const sorted = allResources.sort((a, b) => (a.data.order ?? 0) - (b.data.order ?? 0));

// Map resource types to icons
const resourceIcons = {
  '200-most-used-words': `
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z" stroke-linecap="round" stroke-linejoin="round"/>
      <line x1="9" y1="7" x2="15" y2="7" stroke-linecap="round"/>
      <line x1="9" y1="11" x2="15" y2="11" stroke-linecap="round"/>
      <line x1="9" y1="15" x2="13" y2="15" stroke-linecap="round"/>
    </svg>
  `,
  'case-endings-chart': `
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <rect x="3" y="3" width="18" height="18" rx="2" ry="2" stroke-linecap="round" stroke-linejoin="round"/>
      <line x1="9" y1="3" x2="9" y2="21" stroke-linecap="round"/>
      <line x1="15" y1="3" x2="15" y2="21" stroke-linecap="round"/>
      <line x1="3" y1="9" x2="21" y2="9" stroke-linecap="round"/>
      <line x1="3" y1="15" x2="21" y2="15" stroke-linecap="round"/>
    </svg>
  `,
  'glossary': `
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
  `,
  'pronoun-charts': `
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" stroke-linecap="round" stroke-linejoin="round"/>
      <circle cx="8.5" cy="7" r="4" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M20 8v6M23 11h-6" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
  `,
  'root-system': `
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <circle cx="12" cy="12" r="3" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M12 1v6m0 6v6M5.64 5.64l4.24 4.24m4.24 4.24l4.24 4.24M1 12h6m6 0h6M5.64 18.36l4.24-4.24m4.24-4.24l4.24-4.24" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
  `,
  'verb-conjugation-tables': `
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M9 11l3 3L22 4" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
  `
};
---

<BaseLayout title="Resources" description="Quick-reference charts and guides for Quranic Arabic: verb conjugation tables, pronoun charts, case endings, 200 most-used Quranic words, and Arabic root system guide.">
  <Container size="md" class="page-container">
    <header class="page-header">
      <h1 class="page-title">Resources</h1>
      <p class="page-description">
        Quick-reference charts, tables, and guides for Quranic Arabic grammar.
        Essential tools for your learning journey.
      </p>
    </header>

    <CardGrid minCardWidth={320} gap="md">
      {sorted.map(resource => (
        <ResourceCard
          title={resource.data.title}
          description={resource.data.description}
          href={`/resources/${resource.id}/`}
          data-testid={`resource-${resource.id}`}
        >
          <Fragment slot="icon" set:html={resourceIcons[resource.id as keyof typeof resourceIcons] || resourceIcons['glossary']} />
        </ResourceCard>
      ))}
    </CardGrid>
  </Container>
</BaseLayout>

<style>
  .page-container {
    padding-block: var(--spacing-2xl) var(--spacing-3xl);
  }

  .page-header {
    text-align: center;
    margin-block-end: var(--spacing-3xl);
  }

  .page-title {
    font-size: 2.25rem;
    font-weight: 700;
    color: var(--color-text-primary);
    margin-block-end: var(--spacing-md);
    letter-spacing: -0.02em;
  }

  @media (min-width: 640px) {
    .page-title {
      font-size: 2.75rem;
    }
  }

  .page-description {
    font-size: 1.125rem;
    line-height: 1.6;
    color: var(--color-text-secondary);
    max-inline-size: 600px;
    margin-inline: auto;
  }
</style>
