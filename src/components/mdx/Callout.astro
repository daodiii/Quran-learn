---
/**
 * Callout - Educational callout boxes for lessons
 *
 * Usage examples:
 * <Callout type="rule" title="The Definite Article">
 *   In Arabic, **al-** (ال) makes any noun definite. Unlike English, there is only one article for all genders and numbers.
 * </Callout>
 *
 * <Callout type="warning">
 *   Don't confuse the sun letters with moon letters — they affect pronunciation but not spelling.
 * </Callout>
 */

interface Props {
  type?: 'note' | 'tip' | 'rule' | 'warning';
  title?: string;
}

const { type = 'note', title } = Astro.props;

// Default titles for each type
const defaultTitles: Record<string, string> = {
  note: 'Note',
  tip: 'Tip',
  rule: 'Grammar Rule',
  warning: 'Common Mistake',
};

const displayTitle = title || defaultTitles[type];

// SVG icons for each type
const icons: Record<string, string> = {
  note: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>`,
  tip: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18h6"/><path d="M10 22h4"/><path d="M15 2a7 7 0 0 1 0 12H9a7 7 0 0 1 0-12z"/></svg>`,
  rule: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/></svg>`,
  warning: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>`,
};
---

<aside class={`callout callout-${type}`} role="note">
  <p class="callout-title">
    <span class="callout-icon" set:html={icons[type]} />
    <strong>{displayTitle}</strong>
  </p>
  <div class="callout-content">
    <slot />
  </div>
</aside>

<style>
  .callout {
    background: var(--color-background-elevated);
    border: 2px solid var(--color-border-primary);
    border-radius: var(--radius-xl);
    padding: var(--spacing-xl) var(--spacing-2xl);
    margin-block: var(--spacing-2xl);
    box-shadow: var(--shadow-elevated);
    position: relative;
    overflow: hidden;
  }

  /* Left accent bar with gradient */
  .callout::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    bottom: 0;
    width: 6px;
    border-radius: var(--radius-xl) 0 0 var(--radius-xl);
  }

  /* Type-specific: warm gradient tints */
  .callout-note { background: linear-gradient(135deg, #F0EDF7 0%, #FAF8F5 100%); border-color: #1A1147; }
  .callout-note::after { background: linear-gradient(180deg, #1A1147, #B8860B); }

  .callout-tip { background: linear-gradient(135deg, #F2F6F2 0%, #FAF8F5 100%); border-color: #617D61; }
  .callout-tip::after { background: #617D61; }

  .callout-rule { background: linear-gradient(135deg, #FBF7ED 0%, #FAF8F5 100%); border-color: #B8860B; }
  .callout-rule::after { background: linear-gradient(180deg, #B8860B, #D4A849, #F2D98C); }

  .callout-warning { background: linear-gradient(135deg, #FDF6F3 0%, #FAF8F5 100%); border-color: #C4704B; }
  .callout-warning::after { background: #C4704B; }

  /* Dark Mode */
  :global([data-theme="dark"]) .callout-note { background: linear-gradient(135deg, #1E1B28 0%, #221E1C 100%); color: #9B88E8; border-color: #2A2442; }
  :global([data-theme="dark"]) .callout-tip { background: linear-gradient(135deg, #1F2B1F 0%, #221E1C 100%); color: #8FB88F; border-color: #2A4E3B; }
  :global([data-theme="dark"]) .callout-rule { background: linear-gradient(135deg, #2D2818 0%, #221E1C 100%); color: #F2D98C; border-color: #4D3F18; }
  :global([data-theme="dark"]) .callout-warning { background: linear-gradient(135deg, #2D2118 0%, #221E1C 100%); color: #E89B7A; border-color: #4D3328; }

  .callout-title {
    display: flex;
    align-items: center;
    gap: var(--spacing-md);
    font-family: var(--font-display);
    font-size: 0.875rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.12em;
    margin: 0 0 var(--spacing-lg) 0;
    color: var(--text-primary);
  }

  .callout-icon {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    inline-size: 1.25rem;
    block-size: 1.25rem;
  }

  .callout-icon :global(svg) {
    inline-size: 100%;
    block-size: 100%;
  }

  .callout-content {
    font-size: 1rem;
    line-height: 1.7;
    color: var(--color-text-primary);
  }

  .callout-content :global(p) {
    margin-block-end: var(--spacing-md);
  }

  .callout-content :global(p:last-child) {
    margin-block-end: 0;
  }

  .callout-content :global(ul),
  .callout-content :global(ol) {
    margin-block-start: var(--spacing-sm);
    margin-block-end: var(--spacing-sm);
    padding-inline-start: var(--spacing-lg);
  }

  .callout-content :global(li) {
    margin-block-end: 0.25rem;
  }

  .callout-content :global(strong) {
    color: var(--color-text-primary);
  }

  .callout-content :global(code) {
    font-size: 0.875em;
  }

  /* Ensure Arabic text inside callouts has proper letter spacing */
  .callout-content :global([lang="ar"]) {
    letter-spacing: 0;
  }

  /* Mobile: tighter padding */
  @media (max-width: 640px) {
    .callout {
      padding: var(--spacing-md) var(--spacing-lg);
      margin-block: var(--spacing-lg);
      border-radius: var(--radius-lg);
    }

    .callout-title {
      gap: var(--spacing-sm);
      margin-block-end: var(--spacing-md);
    }
  }
</style>
