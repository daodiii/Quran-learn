---
/**
 * Callout - Educational callout boxes for lessons
 *
 * Usage examples:
 * <Callout type="rule" title="The Definite Article">
 *   In Arabic, **al-** (ال) makes any noun definite. Unlike English, there is only one article for all genders and numbers.
 * </Callout>
 *
 * <Callout type="warning">
 *   Don't confuse the sun letters with moon letters — they affect pronunciation but not spelling.
 * </Callout>
 */

interface Props {
  type?: 'note' | 'tip' | 'rule' | 'warning';
  title?: string;
}

const { type = 'note', title } = Astro.props;

// Default titles for each type
const defaultTitles: Record<string, string> = {
  note: 'Note',
  tip: 'Tip',
  rule: 'Grammar Rule',
  warning: 'Common Mistake',
};

const displayTitle = title || defaultTitles[type];

// SVG icons for each type
const icons: Record<string, string> = {
  note: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>`,
  tip: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18h6"/><path d="M10 22h4"/><path d="M15 2a7 7 0 0 1 0 12H9a7 7 0 0 1 0-12z"/></svg>`,
  rule: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/></svg>`,
  warning: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>`,
};
---

<aside class={`callout callout-${type}`} role="note">
  <p class="callout-title">
    <span class="callout-icon" set:html={icons[type]} />
    <strong>{displayTitle}</strong>
  </p>
  <div class="callout-content">
    <slot />
  </div>
</aside>

<style>
  .callout {
    background: var(--color-background-elevated);
    border: 1px solid var(--color-border-primary);
    border-radius: 16px;
    padding: var(--spacing-lg) var(--spacing-xl);
    margin-block: var(--spacing-2xl);
    box-shadow: var(--shadow-sm);
    position: relative;
    overflow: hidden;
  }

  /* Type-specific background tints and accents */
  .callout::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    bottom: 0;
    width: 6px;
  }

  .callout-note { background: #F0F4F8; color: #102A43; }
  .callout-note::after { background: #102A43; }
  
  .callout-tip { background: #F2F6F2; color: #405240; }
  .callout-tip::after { background: #617D61; }

  .callout-rule { background: #FBF7ED; color: #7A5C29; }
  .callout-rule::after { background: #C5A059; }

  .callout-warning { background: #FEF6F5; color: #8A3E31; }
  .callout-warning::after { background: #D66D5E; }

  /* Dark Mode - Distinct hue-tinted backgrounds matching light mode identity */
  :global([data-theme="dark"]) .callout-note { background: #0C1929; color: #93C5FD; border-color: #1E3A5F; }
  :global([data-theme="dark"]) .callout-tip { background: #0F1A0F; color: #8FB88F; border-color: #1A3A1A; }
  :global([data-theme="dark"]) .callout-rule { background: #1A1608; color: #EAD096; border-color: #3D3010; }
  :global([data-theme="dark"]) .callout-warning { background: #1F1210; color: #F0A090; border-color: #3D1A14; }

  .callout-title {
    display: flex;
    align-items: center;
    gap: var(--spacing-md);
    font-family: var(--font-display);
    font-size: 0.8125rem;
    font-weight: 800;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    margin: 0 0 var(--spacing-md) 0;
  }

  .callout-icon {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    inline-size: 1.25rem;
    block-size: 1.25rem;
  }

  .callout-icon :global(svg) {
    inline-size: 100%;
    block-size: 100%;
  }

  .callout-content {
    font-size: 1rem;
    line-height: 1.7;
    color: var(--color-text-primary);
  }

  .callout-content :global(p) {
    margin-block-end: var(--spacing-md);
  }

  .callout-content :global(p:last-child) {
    margin-block-end: 0;
  }

  .callout-content :global(ul),
  .callout-content :global(ol) {
    margin-block-start: var(--spacing-sm);
    margin-block-end: var(--spacing-sm);
    padding-inline-start: var(--spacing-lg);
  }

  .callout-content :global(li) {
    margin-block-end: 0.25rem;
  }

  .callout-content :global(strong) {
    color: var(--color-text-primary);
  }

  .callout-content :global(code) {
    font-size: 0.875em;
  }

  /* Ensure Arabic text inside callouts has proper letter spacing */
  .callout-content :global([lang="ar"]) {
    letter-spacing: 0;
  }
</style>
