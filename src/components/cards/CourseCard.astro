---
import Card from '../primitives/Card.astro';
import Badge from '../primitives/Badge.astro';
import ProgressBar from '../progress/ProgressBar.astro';

interface Props {
  title: string;
  level: 1 | 2 | 3 | 4 | 5;
  lessonsCompleted: number;
  totalLessons: number;
  href: string;
  class?: string;
  [key: string]: any; // Allow arbitrary HTML attributes
}

const {
  title,
  level,
  lessonsCompleted,
  totalLessons,
  href,
  class: className = '',
  ...rest
} = Astro.props;
---

<Card variant="elevated" href={href} class={`course-card ${className}`} {...rest}>
  <div class="course-card-header">
    <h3 class="course-card-title">{title}</h3>
    <Badge level={level}>Level {level}</Badge>
  </div>

  <div class="course-card-progress">
    <p class="course-card-progress-text">{lessonsCompleted} of {totalLessons} lessons</p>
    <ProgressBar
      value={lessonsCompleted}
      max={totalLessons}
      label={`${title} progress`}
      showLabel={false}
      height="sm"
    />
  </div>

  <div class="course-card-description">
    <slot />
  </div>
</Card>

<style>
  .course-card-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: var(--spacing-md);
    margin-block-end: var(--spacing-lg);
  }

  .course-card-title {
    font-family: var(--font-display);
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--color-text-primary);
    margin: 0;
    line-height: 1.2;
    letter-spacing: -0.01em;
  }

  .course-card-progress {
    margin-block-end: var(--spacing-md);
    background: var(--color-background-secondary);
    padding: var(--spacing-md);
    border-radius: 12px;
  }

  .course-card-progress-text {
    font-family: var(--font-display);
    font-size: 0.8125rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--accent-primary);
    margin: 0;
    margin-block-end: var(--spacing-xs);
  }

  .course-card-description {
    font-size: 0.9375rem;
    line-height: 1.6;
    color: var(--color-text-secondary);
    margin-block-start: var(--spacing-md);
  }

  .course-card-description:empty {
    display: none;
  }

  /* Accessibility: reduced motion */
  @media (prefers-reduced-motion: reduce) {
    .course-card {
      transition: none;
    }
  }
</style>
