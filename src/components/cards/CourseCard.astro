---
import Card from '../primitives/Card.astro';
import Badge from '../primitives/Badge.astro';
import ProgressBar from '../progress/ProgressBar.astro';

interface Props {
  title: string;
  level: 1 | 2 | 3 | 4 | 5;
  lessonsCompleted: number;
  totalLessons: number;
  href: string;
  class?: string;
  [key: string]: any; // Allow arbitrary HTML attributes
}

const {
  title,
  level,
  lessonsCompleted,
  totalLessons,
  href,
  class: className = '',
  ...rest
} = Astro.props;
---

<Card variant="elevated" padding="sm" href={href} class={`course-card ${className}`} {...rest}>
  <div class="course-card-header">
    <h3 class="course-card-title">{title}</h3>
    <Badge level={level}>Level {level}</Badge>
  </div>

  <div class="course-card-progress">
    <p class="course-card-progress-text">{lessonsCompleted} of {totalLessons} lessons</p>
    <ProgressBar
      value={lessonsCompleted}
      max={totalLessons}
      label={`${title} progress`}
      showLabel={false}
      height="sm"
    />
  </div>

  <div class="course-card-description">
    <slot />
  </div>
</Card>

<style>
  .course-card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: var(--spacing-sm);
    margin-block-end: var(--spacing-sm);
  }

  .course-card-title {
    font-family: var(--font-display);
    font-size: 1rem;
    font-weight: 600;
    color: var(--color-text-primary);
    margin: 0;
    line-height: 1.2;
    letter-spacing: -0.02em;
    white-space: nowrap;
  }

  .course-card-progress {
    margin-block-end: var(--spacing-sm);
    background: var(--color-background-secondary);
    padding: var(--spacing-sm) var(--spacing-md);
    border-radius: var(--radius-md);
    border: 1px solid var(--color-border-primary);
  }

  .course-card-progress-text {
    font-family: var(--font-display);
    font-size: 0.6875rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    color: var(--accent-gold);
    margin: 0;
    margin-block-end: 0.25rem;
  }

  .course-card-description {
    font-size: 0.8125rem;
    line-height: 1.5;
    color: var(--color-text-secondary);
    margin-block-start: var(--spacing-sm);
    flex: 1;
  }

  .course-card-description:empty {
    display: none;
  }

  /* Accessibility: reduced motion */
  @media (prefers-reduced-motion: reduce) {
    .course-card {
      transition: none;
    }
  }
</style>
